# Buld Set SSPR Authentication Methods  
Assumptions:
    - You are connected to Graph via an Application Registration with "UserAuthenticationMethod.ReadWrite.All"
    - You have a CSV file with the following columns:
        - upn
        - email
        - phone
    - The provided attributes are valid, approved, and can be used to set new user authentication methods on the user objects
    - Only phone and email can be set via automation

Algorithm:
    - This script will take a CSV file with the following columns and create an array with it:
        - upn
        - email
        - phone
    - A new PowerShell object is instantiated to extend the attributes of the original CSV file  into $psobjResolvedUserStatus
    - The script will then attempt to resolve the user in Azure AD
        - If the user is resolved:
            - Attributes of the resolved object are added to the psobject array
        - If the user is not resolved:
            - Imported attributes are preserved and error results are added to the psobject array
        - Whether the user is resolved or not, these attributes are defined and used in $psobjAuthMethodResults which is used to provide verbose output:
            - Id
            - DisplayName
            - NewEmail
            - OldEmail
            - NewPhone
            - OldPhone
            - UPN
            - Result
            - AuthMethodEmailSet
            - AuthMethodPhoneSet
            - RawError
    - The script will then seperates the resolved users from the unresolved users into seperate arrays
    - The unresolved users are added to the final output array and the resolved users are added to an array to process through setting the authentication methods
    - The script will then attempt to set the authentication methods for the resolved users and add the results to the final output array $psobjAuthMethodResults
        - The script will attempt to set the email authentication method
            - If the email authentication method is set:
                - The AuthMethodEmailSet attribute is set to true
                - The Result attribute appends "Email Authentication Method Set"
            - If the email authentication method is not set:
                - The AuthMethodEmailSet attribute is set to false
                - The Result attribute appends "Email Authentication Method Not Set"
                - The RawError attribute appends the error message
        - The script will attempt to set the phone authentication method
            - If the phone authentication method is set:
                - The AuthMethodPhoneSet attribute is set to true
                - The Result attribute appends "Phone Authentication Method Set"
            - If the phone authentication method is not set:
                - The AuthMethodPhoneSet attribute is set to false
                - The Result attribute appends "Phone Authentication Method Not Set"
                - The RawError attribute appends the error message
    - The final output table with the results of the script is exported to a CSV file in the specified directory #>  